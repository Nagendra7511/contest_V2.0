<div class="backdrop" *ngIf="loading">
  <div class="loader"></div>
</div>

<div class="container pt-5 pb-3">

  <div class="brand-profile-container justify-content-center">
    <div class="brand-profile-left">
      <div class="gradient-ring">
        <div class="brand-profile-image">
          <img [src]="storeData?.logo || '/images/brand_icon.png'" alt="Brand Logo" />
        </div>
      </div>
    </div>

    <div class="brand-profile-right">
      <h2 class="brand-profile-name">{{ storeData?.name }}</h2>

      <div class="brand-profile-stats">
        <div>Contests <br /><strong>{{ brand.length }}</strong></div>
        <div>
          Participants <br />
          <svg height="20px" width="20px" fill="#1ABC9C">
            <path
              d="M60-413q-29-45-44.5-91T0-600q0-110 75.5-187T264-864q62 0 118 26t98 74q42-48 98-74t118-26q113 0 188.5 77T960-600q0 48-15.5 95T900-413q-8-18-21.5-31.5T848-466q20-33 30-67.5t10-66.5q0-80-54.5-136T696-792q-58 0-113 35T480-653q-48-69-103-104t-113-35q-83 0-137.5 56T72-600q0 35 10 68t30 66q-15 8-28 21.5T60-413ZM0-96v-50q0-44 45-69t123-25q12 0 21.5.5T207-237q-6 13-10.5 30t-4.5 40v71H0Zm240 0v-71q0-66 65.5-105.5T480-312q109 0 174.5 39.5T720-167v71H240Zm528 0v-71q0-24-4.5-40.5T753-237q8-2 17.5-2.5t21.5-.5q78 0 123 25t45 69v50H768ZM480-240q-75 0-116 20t-52 52h336q-11-32-52-52t-116-20Z" />
          </svg>
          <strong>{{ totalResultCount }}</strong>
        </div>
      </div>
    </div>

    <!-- GLOBAL SHARE BUTTON -->
    <div class="brand-share1 global-share" (click)="openGlobalShare()">
      <i class="fas fa-share"></i>
    </div>
  </div>

</div>

<section class="container" *ngIf="userId && (!profile?.gender 
  || !profile?.month_of_birth 
  || !profile?.year_of_birth 
  || !profile?.nationality 
  || !profile?.first_name 
  || !profile?.last_name 
  || !profile?.phone_number 
  || !profile?.phone_country_code)">
  <div class="col-12 p-0 text-center">
    <a routerLink="/profile" class="redirection" class="missing">
      <i class="fa fa-user-circle" aria-hidden="true"></i>

      <span>Complete your profile and receive more updates from your favorite brands</span>
    </a>
  </div>
</section>


<section class="container top-bottom-space mt-4">

  <!-- Tabs -->
  <ul class="nav nav-pills" role="tablist">
    <li class="nav-item col-6 p-0">
      <div class="blog_section nav-link" [ngClass]="{ 'active': activeTab === 'info' }" (click)="setActiveTab('info')">
        <div class="box b1">
          <div class="detail-box">
            <h3>Contests</h3>
          </div>
        </div>
      </div>
    </li>

    <li class="nav-item col-6 p-0">
      <div class="blog_section nav-link" [ngClass]="{ 'active': activeTab === 'links' }"
        (click)="setActiveTab('links')">
        <div class="box b1">
          <div class="detail-box">
            <h3>Links</h3>
          </div>
        </div>
      </div>
    </li>
  </ul>

  <!-- Tab Content -->
  <div class="tab-content">

    <!-- Contests TAB -->
    <div *ngIf="activeTab === 'info'" class="container"><br>

      <div class="row">
        <div class="col-md-4 mb-4" *ngFor="let item of brand">
          <div class="contest-game pointer" [ngClass]="{ 'expired-card': item.expired }"
            (click)="navigateToContest(item)">

            <div class="img-box">
              <div class="game-banner">
                <img [src]="item.background_image || 'images/logo.png'" alt="{{ item.name }}">
              </div>

              <div class="play-btn">
                <div class="play-icon">
                  <div class="total-count">
                    <i class="fa fa-users font-14"></i> {{ item.result_count }}
                  </div>
                </div>
              </div>

              <div class="leaderboard" data-toggle="modal" data-target="#leaderboardModal1"
                (click)="openLeaderboard(item.contest_id, $event);"> <svg xmlns="http://www.w3.org/2000/svg"
                  height="24px" viewBox="0 -960 960 960" width="24px" fill="#5f6368">
                  <path
                    d="M480-517q37 0 62.5-25.5T568-605q0-37-25.5-62.5T480-693q-37 0-62.5 25.5T392-605q0 37 25.5 62.5T480-517ZM298-120v-60h152v-148q-54-11-96-46.5T296-463q-74-8-125-60t-51-125v-44q0-25 17.5-42.5T180-752h104v-88h392v88h104q25 0 42.5 17.5T840-692v44q0 73-51 125t-125 60q-16 53-58 88.5T510-328v148h152v60H298Zm-14-406v-166H180v44q0 45 29.5 78.5T284-526Zm196 141q57 0 96.5-40t39.5-97v-258H344v258q0 57 39.5 97t96.5 40Zm196-141q45-10 74.5-43.5T780-648v-44H676v166Zm-196-57Z" />
                </svg> </div>

            </div>

            <div class="game-info pointer">
              <!-- <h3>{{ item.stores?.name }}</h3> -->

              <div class="subTitle">
                <h3 class="Doted-text">{{ item.contest_name }}</h3>
                <div class="insta-icon" *ngIf="item.insta_post">
                  <img src="images/insta.png" alt="Instagram">
                </div>
              </div>
              <p class="m-0">
                <i class="fa fa-calendar pr-2"></i>
                <span>{{ item.start_date | date:'dd-MMM-yyyy' }}</span>
                to
                <span>{{ item.end_date | date:'dd-MMM-yyyy' }}</span>
              </p>
            </div>

          </div>
        </div>
      </div>

    </div>

    <!-- Links TAB -->
    <div *ngIf="activeTab === 'links'" class="container"><br>

      <div class="pb-5">

        <div class="brand-links">
          <div class="brand-link-card others" *ngFor="let link of brandInfo?.external_links"
            (click)="openLink(link.url)">

            <div class="brand-top">
              <div class="brand-icon"><i class="fas fa-globe"></i></div>
              <div class="brand-content">
                <p>{{ link.description }}</p>
              </div>

              <div class="brand-share" (click)="openBrandShare(link.url); $event.stopPropagation()">
                <i class="fas fa-share"></i>
              </div>
            </div>

          </div>
        </div>


        <!-- Social icons -->
        <div class="social_box mt-4">
          <a *ngIf="brandInfo?.social_links?.instagram" [href]="brandInfo?.social_links?.instagram" target="_blank">
            <img src="images/insta.png" alt="instagram">
          </a>
          <a *ngIf="brandInfo?.social_links?.whatsapp" [href]="brandInfo?.social_links?.whatsapp" target="_blank">
            <img src="images/whatsapp.png" alt="whatsapp">
          </a>
          <a *ngIf="brandInfo?.social_links?.facebook" [href]="brandInfo?.social_links?.facebook" target="_blank">
            <img src="images/fb.png" alt="facebook">
          </a>
          <a *ngIf="brandInfo?.social_links?.youtube" [href]="brandInfo?.social_links?.youtube" target="_blank">
            <img src="images/you_tube.png" alt="youtube">
          </a>
          <a *ngIf="brandInfo?.snapchat" [href]="brandInfo?.social_links?.snapchat" target="_blank">
            <img src="images/snap.png" alt="snapchat">
          </a>
          <a *ngIf="brandInfo?.social_links?.x" [href]="brandInfo?.social_links?.x" target="_blank">
            <img src="images/x.png" alt="X">
          </a>
          <a *ngIf="brandInfo?.social_links?.threads" [href]="brandInfo?.social_links?.threads" target="_blank">
            <img src="images/thread.png" alt="thread">
          </a>

          <a *ngIf="brandInfo?.social_links?.tiktok" [href]="brandInfo?.social_links?.tiktok" target="_blank">
            <img src="images/tiktok.png" alt="tiktok">
          </a>
        </div>

      </div>
       <div class="text-center col-12">
        <a class="btn btn-primary btn-green text-center mt-3" href="https://brands.contest-central.com/" target="_blank">Start as a Brand</a>
      </div>


    </div>

    

  </div>

</section>

<!-- Modal -->
<div class="modal fade" id="leaderboardModal1" tabindex="-1" role="dialog" aria-labelledby="leaderboardModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Leaderboard</h5> <button type="button" class="close" data-dismiss="modal"
          aria-label="Close"> <span aria-hidden="true">&times;</span> </button>
      </div>
      <div class="modal-body">
        <table class="w-100 table table-striped" *ngIf="!utilService.loading && utilService.leaderBoardList.length > 0">
          <tbody>
            <tr *ngFor="let item of utilService.leaderBoardList">
              <td width="70">{{ item.first_name ?? item.insta_username }}</td>
              <td width="30" class="text-center">{{ item.score }}</td>
            </tr>
          </tbody>
        </table>
        <p *ngIf="utilService.notificationMessage" class="leaderBoard-notification">{{ utilService.notificationMessage}}
        </p>
      </div>
    </div>
  </div>
</div>



<!-- SHARE MODAL -->
<div class="modal fade" id="shareModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title text-center">Share</h5>
        <button type="button" class="close" data-dismiss="modal">
          <span>&times;</span>
        </button>
      </div>

      <div class="modal-body text-center">

        <!-- URL Preview -->
        <p class="share-url mb-3">{{ selectedShareUrl }}</p>



        <!-- Social Icons Grid -->
        <div class="share-icons">
          <!-- Copy Link -->
          <button class="btn btn-primary mb-1" (click)="copyLink()">{{ copyBtnText }}</button>

          <div class="share-icon" (click)="shareTo('whatsapp')">
            <img src="images/whatsapp.png" alt="WhatsApp">
          </div>

          <div class="share-icon" (click)="shareTo('facebook')">
            <img src="images/fb.png" alt="Facebook">
          </div>

          <div class="share-icon" (click)="shareTo('twitter')">
            <img src="images/x.png" alt="Twitter / X">
          </div>

          <div class="share-icon" (click)="shareTo('instagram')">
            <img src="images/insta.png" alt="Instagram">
          </div>

          <div class="share-icon" (click)="shareTo('snapchat')">
            <img src="images/snap.png" alt="Snapchat">
          </div>

          <div class="share-icon" (click)="shareTo('threads')">
            <img src="images/thread.png" alt="Threads">
          </div>

          <div class="share-icon" (click)="shareTo('tiktok')">
            <img src="images/tiktok.png" alt="TikTok">
          </div>

          <!-- <div class="share-icon" (click)="shareTo('youtube')">
            <img src="images/you_tube.png" alt="YouTube">
          </div> -->

        </div>

      </div>

    </div>
  </div>
</div>